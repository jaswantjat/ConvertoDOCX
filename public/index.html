<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOCX Generator API - Exercise Preview</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f6f8fa;
            color: #24292e;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .header h1 {
            color: #0366d6;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #586069;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-panel, .preview-panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .form-panel h2, .preview-panel h2 {
            margin-bottom: 20px;
            color: #24292e;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #24292e;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5da;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
            font-family: 'SFMono-Regular', Consolas, monospace;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #0366d6;
            box-shadow: 0 0 0 3px rgba(3, 102, 214, 0.1);
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .btn-primary {
            background: #0366d6;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0256cc;
        }
        
        .btn-secondary {
            background: #f3f4f6;
            color: #24292e;
            border: 1px solid #d1d5da;
        }
        
        .btn-secondary:hover {
            background: #e1e4e8;
        }
        
        .preview-frame {
            width: 100%;
            height: 600px;
            border: 1px solid #d1d5da;
            border-radius: 4px;
            background: white;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #586069;
        }
        
        .error {
            background: #ffeaea;
            color: #d73a49;
            padding: 12px;
            border-radius: 4px;
            margin: 10px 0;
            display: none;
        }
        
        .success {
            background: #e6ffed;
            color: #28a745;
            padding: 12px;
            border-radius: 4px;
            margin: 10px 0;
            display: none;
        }
        
        .api-key-input {
            background: #fff5b4;
            border-color: #d1b23a;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŽ“ DOCX Generator API - Exercise Preview</h1>
            <p>Create and preview coding exercises in both HTML and DOCX formats</p>
        </div>
        
        <div class="main-content">
            <div class="form-panel">
                <h2>Exercise Configuration</h2>
                
                <div class="form-group">
                    <label for="apiKey">API Key:</label>
                    <input type="password" id="apiKey" class="api-key-input" placeholder="Enter your API key" value="test-key-123">
                </div>
                
                <div class="form-group">
                    <label for="topic">Topic:</label>
                    <input type="text" id="topic" placeholder="e.g., Python" value="Python">
                </div>
                
                <div class="form-group">
                    <label for="subtopic">Subtopic:</label>
                    <input type="text" id="subtopic" placeholder="e.g., Web Scraping" value="Conditional branching for element presence verification">
                </div>
                
                <div class="form-group">
                    <label for="difficulty">Difficulty:</label>
                    <select id="difficulty">
                        <option value="Easy" selected>Easy</option>
                        <option value="Medium">Medium</option>
                        <option value="Hard">Hard</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="language">Programming Language:</label>
                    <select id="language">
                        <option value="python" selected>Python</option>
                        <option value="javascript">JavaScript</option>
                        <option value="java">Java</option>
                        <option value="cpp">C++</option>
                        <option value="csharp">C#</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="questionDescription">Question Description:</label>
                    <textarea id="questionDescription" placeholder="Describe the exercise...">Alex needs to perform several tasks involving web scraping using Python's Conditional branching for element presence verification. The code uses the requests library to fetch webpage content and BeautifulSoup to parse HTML.</textarea>
                </div>
                
                <div class="form-group">
                    <label for="codeBlock">Code Template:</label>
                    <textarea id="codeBlock" placeholder="Enter code with blanks...">import requests
from bs4 import BeautifulSoup

def main():
    url = "https://example.com"
    
    # Blank 1: Enter your code here
    page_content = Blank 1: Enter your code here
    
    # Blank 2: Enter your code here
    soup = Blank 2: Enter your code here
    
    print("Scraping completed!")

if __name__ == "__main__":
    main()</textarea>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary" onclick="generatePreview('html')">Preview HTML</button>
                    <button class="btn btn-secondary" onclick="generatePreview('docx')">Download DOCX</button>
                    <button class="btn btn-secondary" onclick="loadSampleData()">Load Sample</button>
                </div>
                
                <div class="error" id="errorMessage"></div>
                <div class="success" id="successMessage"></div>
                <div class="loading" id="loadingMessage">Generating exercise...</div>
            </div>
            
            <div class="preview-panel">
                <h2>Preview</h2>
                <iframe id="previewFrame" class="preview-frame" src="about:blank"></iframe>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = window.location.origin;
        
        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
            document.getElementById('successMessage').style.display = 'none';
        }
        
        function showSuccess(message) {
            const successEl = document.getElementById('successMessage');
            successEl.textContent = message;
            successEl.style.display = 'block';
            document.getElementById('errorMessage').style.display = 'none';
        }
        
        function hideMessages() {
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('successMessage').style.display = 'none';
        }
        
        function showLoading(show) {
            document.getElementById('loadingMessage').style.display = show ? 'block' : 'none';
        }
        
        function getFormData() {
            return {
                topic: document.getElementById('topic').value,
                subtopic: document.getElementById('subtopic').value,
                difficulty: document.getElementById('difficulty').value,
                language: document.getElementById('language').value,
                questionDescription: document.getElementById('questionDescription').value,
                codeBlock: document.getElementById('codeBlock').value,
                questionNumber: 1,
                instructions: [
                    { blankNumber: 1, instruction: "Import the required libraries" },
                    { blankNumber: 2, instruction: "Parse the HTML content" }
                ],
                answers: [
                    { answerNumber: 1, answerCode: "requests.get(url).text" },
                    { answerNumber: 2, answerCode: "BeautifulSoup(page_content, 'html.parser')" }
                ]
            };
        }
        
        async function generatePreview(format) {
            hideMessages();
            showLoading(true);
            
            try {
                const apiKey = document.getElementById('apiKey').value;
                if (!apiKey) {
                    throw new Error('Please enter your API key');
                }
                
                const exerciseData = {
                    ...getFormData(),
                    format: format
                };
                
                const response = await fetch(`${API_BASE}/api/generate-exercise`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': apiKey
                    },
                    body: JSON.stringify(exerciseData)
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || 'Generation failed');
                }
                
                if (format === 'html') {
                    const htmlContent = await response.text();
                    const previewFrame = document.getElementById('previewFrame');
                    previewFrame.srcdoc = htmlContent;
                    showSuccess('HTML exercise generated successfully!');
                } else {
                    // For DOCX, trigger download
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `exercise_${exerciseData.topic}_${Date.now()}.docx`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                    showSuccess('DOCX exercise downloaded successfully!');
                }
                
            } catch (error) {
                showError(error.message);
            } finally {
                showLoading(false);
            }
        }
        
        function loadSampleData() {
            document.getElementById('topic').value = 'Python';
            document.getElementById('subtopic').value = 'Conditional branching for element presence verification';
            document.getElementById('difficulty').value = 'Easy';
            document.getElementById('language').value = 'python';
            document.getElementById('questionDescription').value = 'Alex needs to perform several tasks involving web scraping using Python\'s Conditional branching for element presence verification. The code uses the requests library to fetch webpage content and BeautifulSoup to parse HTML.';
            document.getElementById('codeBlock').value = `import requests
from bs4 import BeautifulSoup

class WebScraper:
    def __init__(self, url, element_id):
        self.url = url
        self.element_id = element_id

def main():
    url = "https://example.com"
    element_id = "main-content"
    
    scraper = WebScraper(url, element_id)
    
    # 1. Fetch webpage content from URL
    page_content = Blank 1: Enter your code here
    
    # 2. Parse the webpage content using BeautifulSoup
    soup = Blank 2: Enter your code here
    
    # 3. Find the HTML element with the specific id
    element = Blank 3: Enter your code here
    
    # 4. Create a dictionary with url and whether element is found
    result = Blank 4: Enter your code here
    
    # 5. Print whether the element was found
    print(Blank 5: Enter your code here)

if __name__ == "__main__":
    main()`;
            
            showSuccess('Sample data loaded! Click "Preview HTML" to see the result.');
        }
        
        // Load sample data on page load
        window.addEventListener('load', function() {
            // Show a welcome message in the preview frame
            const previewFrame = document.getElementById('previewFrame');
            previewFrame.srcdoc = `
                <div style="padding: 40px; text-align: center; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
                    <h2 style="color: #0366d6; margin-bottom: 20px;">ðŸŽ“ Welcome to Exercise Preview</h2>
                    <p style="color: #586069; margin-bottom: 20px;">Configure your exercise settings on the left and click "Preview HTML" to see the generated exercise.</p>
                    <p style="color: #586069;">You can also click "Load Sample" to see an example exercise.</p>
                </div>
            `;
        });
    </script>
</body>
</html>
